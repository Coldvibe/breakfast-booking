<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Zakfast ‚Äì R√©servation petit-d√©jeuner</title>
  <link rel="stylesheet" href="/static/css/app.css">
</head>
<body>
  <div class="container">

    <div class="header">
  <div class="brand">
    <div class="logo egg-logo" aria-label="Zack & Snack">
      <!-- ton SVG oeuf ici -->
      <svg viewBox="0 0 64 64" width="28" height="28" aria-hidden="true">
        <path d="M32 6 C20 6 10 18 10 30 c0 12 10 22 22 22 s22-10 22-22 C54 18 44 6 32 6Z"
              fill="#ffffff" opacity="0.95" />
        <circle cx="32" cy="32" r="8" fill="#facc15"/>
      </svg>
    </div>
    <div>
      <h1>Zack & Snack</h1>
      <p>R√©servation petit-d√©jeuner ‚Ä¢ √âquipe de Zakaria</p>
    </div>
  </div>

  <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap">
    <div class="badge">Petit-d√©jeuner du <b>{{ event["date"] }}</b></div>

    <a class="admin-lock {% if request.session.get('admin') %}unlocked{% else %}locked{% endif %}"
   href="/admin/go"
   title="{% if request.session.get('admin') %}Admin connect√©{% else %}Acc√®s admin{% endif %}">
  {% if request.session.get("admin") %}
    üîì
  {% else %}
    üîí
  {% endif %}
</a>

  
    </a>
  </div>
</div>


    <div class="grid">

      <!-- Colonne gauche -->
      <div class="card">
        <h2 class="card-title">R√©server</h2>
        <div class="menu-box">
  <div class="menu-title">Menu de demain</div>
  <div class="menu-items">
    {% for item in event.menu %}
      <label class="menu-chip">
        <input type="checkbox" value="{{ item }}">
        <span>{{ item }}</span>
      </label>
    {% endfor %}
  </div>
</div>

        <div class="muted">
          Menu : <b>{{ ", ".join(event["menu"]) }}</b>
        </div>

        <hr class="hr">

        {% if event["open"] %}
          <div class="badge">R√©servations ouvertes</div>
        {% else %}
          <div class="badge" style="border-color:rgba(239,68,68,.35);color:#ffd2d2;background:rgba(239,68,68,.08)">
            R√©servations ferm√©es
          </div>
        {% endif %}

        <form class="form" method="post" action="/reserve" style="margin-top:12px">
          <div>
            <label>Ton nom</label>
            <input name="name" placeholder="Ex: Ben" required {% if not event["open"] %}disabled{% endif %}>
          </div>

          <div>
            <label>Ce que tu prends (s√©par√© par virgules)</label>
            <input name="items" placeholder="Ex: ≈íufs, Pain" {% if not event["open"] %}disabled{% endif %}>
          </div>

          <div>
            <label>Tu ram√®nes quelque chose ?</label>
            <input name="bring" placeholder="Ex: 1 paquet de pancakes" {% if not event["open"] %}disabled{% endif %}>
          </div>

          <button class="btn" type="submit" {% if not event["open"] %}disabled{% endif %}>
            Valider la r√©servation
          </button>

          <div class="footer-note">
            Astuce : si tu ram√®nes quelque chose, indique-le pour que tout le monde le voie üôÇ
          </div>
        </form>
      </div>

      <!-- Colonne droite -->
      <div class="card">
        <h2 class="card-title">R√©servations</h2>

        <div class="kpis">
          <div class="kpi">
            <b>{{ reservations|length }}</b>
            <span>r√©servation(s)</span>
          </div>
          <div class="kpi">
            <b>{{ "Ouvert" if event["open"] else "Ferm√©" }}</b>
            <span>statut</span>
          </div>
        </div>

        <hr class="hr">

        {% if reservations|length == 0 %}
          <div class="muted">Aucune r√©servation pour l‚Äôinstant.</div>
        {% else %}
          <div class="list">
            {% for r in reservations %}
              <div class="item">
                <div class="name">{{ r["name"] }}</div>
                <div class="meta">
                  <div><span class="muted">Prend :</span> {{ ", ".join(r["items"]) if r["items"] else "‚Äî" }}</div>
                  <div><span class="muted">Ram√®ne :</span> {{ r["bring"] if r["bring"] else "‚Äî" }}</div>
                </div>
              </div>
            {% endfor %}
          </div>
        {% endif %}

        {% if request.session.get("admin") %}
          <hr class="hr">
          <form method="post" action="/admin/toggle">
            <button class="btn secondary" type="submit">
              {{ "Fermer les r√©servations" if event["open"] else "Ouvrir les r√©servations" }}
            </button>
          </form>
          <div class="footer-note">Visible uniquement pour l‚Äôadmin connect√©.</div>
        {% endif %}
      </div>

    </div>
  </div>
  <script>
  const checkboxes = document.querySelectorAll('.menu-chip input');
  const itemsInput = document.querySelector('input[name="items"]');

  function syncItems(){
    const values = Array.from(checkboxes)
      .filter(c => c.checked)
      .map(c => c.value);
    itemsInput.value = values.join(', ');
  }

  checkboxes.forEach(c => c.addEventListener('change', syncItems));
</script>

</body>
</html>
