<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Admin — Plats</title>
  <link rel="stylesheet" href="/static/css/app.css">
</head>
<body>
<div class="container">

  <div class="header">
    <div class="brand">
      <div class="logo egg-logo">
        <svg viewBox="0 0 64 64" width="28" height="28">
          <path d="M32 6 C20 6 10 18 10 30 c0 12 10 22 22 22 s22-10 22-22 C54 18 44 6 32 6Z"
                fill="#fff" opacity="0.95"/>
          <circle cx="32" cy="32" r="8" fill="#facc15"/>
        </svg>
      </div>
      <div>
        <h1>Plats / Recettes</h1>
        <p>Préparations proposées aux agents</p>
      </div>
    </div>

    <div style="display:flex;gap:10px">
      <a class="btn secondary" href="/admin">Dashboard</a>
      <a class="btn secondary" href="/admin/foods">Aliments</a>
    </div>
  </div>

  <div class="grid" style="grid-template-columns: 1fr 1fr;">
    <div class="card">
      <h2 class="card-title">Ajouter un plat</h2>
      <form class="form" method="post" action="/admin/recipes/add">
        <div>
          <label>Nom</label>
          <input name="name" placeholder="Ex : Œuf au plat" required>
        </div>
        <button class="btn" type="submit">Ajouter</button>
      </form>
    </div>

    <div class="card">
      <h2 class="card-title">Liste</h2>

      {% if recipes|length == 0 %}
        <div class="muted">Aucun plat pour l’instant.</div>
      {% else %}
        <div class="list">
          {% for r in recipes %}
            <div class="item" style="display:flex;justify-content:space-between;align-items:center">
              <div>
                <div class="name">{{ r["name"] }}</div>
                {% if not r["is_active"] %}
                  <div class="meta" style="color:#ffd2d2">Inactif</div>
                {% endif %}
              </div>

              <form method="post" action="/admin/recipes/toggle">
                <input type="hidden" name="recipe_id" value="{{ r['id'] }}">
                <input type="hidden" name="is_active" value="{{ 0 if r['is_active'] else 1 }}">
                <a class="btn secondary"
     href="/admin/recipes/edit/{{ r.id }}">
     ✏️ Modifier
  </a>
                {% if r["is_active"] %}
                  <button class="btn danger">Désactiver</button>
                {% else %}
                  <button class="btn secondary">Réactiver</button>
                {% endif %}
              </form>
            </div>
          {% endfor %}
        </div>
      {% endif %}
    </div>
  </div>

</div>
</body>
</html>
